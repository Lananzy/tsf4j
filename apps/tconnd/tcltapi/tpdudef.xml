<?xml version="1.0" encoding="GBK" standalone="yes" ?>

<metalib tagsetversion="1" name="" version="10" >

<macro name="TPDU_MAX_ENCRYPTSKEY_LEN"    value="128" />
<macro name="TPDU_MAX_ENCRYPTIDENT_LEN"   value="64" />
<macro name="TPDU_MAX_ENCRYPTSYN_LEN"     value="128" />
<macro name="TPDU_MAX_ENCRYPTSYNACK_LEN"     value="128" />
<macro name="TPDU_MAGIC" value="0x55" />
<macro name="TPDU_VERSION" value="10" />

<macrosgroup name="TPDU_CMD" >
	<macro name="TPDU_CMD_NONE" value="0" />
	<macro name="TPDU_CMD_CHGSKEY" value="1" />
	<macro name="TPDU_CMD_QUEINFO" value="2" />
	<macro name="TPDU_CMD_AUTH" value="3" />
	<macro name="TPDU_CMD_IDENT" value="4" />
	<macro name="TPDU_CMD_PLAIN" value="5" />
	<macro name="TPDU_CMD_RELAY" value="6" />
	<macro name="TPDU_CMD_STOP" value="7" />
	<macro name="TPDU_CMD_SYN" value="8" />
	<macro name="TPDU_CMD_SYNACK" value="9" />
</macrosgroup>

<macrosgroup name="TPDU_RELAY_TYPE" >
  <macro name="TPDU_JUMP_SERVER_RELAY"      value="1" />
	<macro name="TPDU_NETWORK_FAILURE_RELAY"  value="2" />
	<macro name="TPDU_CLIENT_CRASH_RELAY"  value="3" />
</macrosgroup>

<macrosgroup name="TPDU_STOP_REASON" >
    <!-- the follow definiton is generated by tconnd  -->	
	    <macro name="TPDU_STOP_TCONND_SHUTDOWN"     value="6" />
	  <!-- the follow definiton is generated by server  -->	
      <macro name="TPDU_STOP_SVR_CLOSE"    value="11" />
    	<macro name="TPDU_STOP_SVR_KICKOFF"  value="12" />
    	<macro name="TPDU_STOP_CLI_RELOGIN"  value="13" />
    	<macro name="TPDU_STOP_CLI_LOGOUT"   value="14" />
</macrosgroup>

<struct name="TPDUBase" version="10" >
	<entry name="Magic" type="tinyuint" />
	<entry name="Version" type="tinyuint" />
	<entry name="Cmd" type="tinyuint" />
	<entry name="HeadLen" type="tinyuint" />
	<entry name="BodyLen" type="int" />
</struct>

<struct name="TPDUExtChgSkey" version="10" >
	<entry name="Type" type="short" />
	<entry name="Len" type="short" />
	<entry name="EncryptSkey" type="tinyint" count="TPDU_MAX_ENCRYPTSKEY_LEN" refer="Len" />
</struct>

<struct name="TPDUExtQueInfo" version="10" >
	<entry name="Pos" type="int" />
	<entry name="Max" type="int" />
</struct>

<union name="TPDUExtAuthData" version="10" >
	<entry name="AuthQQV1"      type="TQQAuthInfo"        id="TSEC_AUTH_QQV1" />
	<entry name="AuthQQV2"      type="TQQAuthInfo"        id="TSEC_AUTH_QQV2" />
	<entry name="AuthQQUnified" type="TQQUnifiedAuthInfo" id="TSEC_AUTH_QQUNIFIED" />
</union>

<struct name="TPDUExtAuthInfo" version="10" >
	<entry name="AuthType" type="int" bindmacrosgroup="TSEC_AUTH" />
	<entry name="AuthData" type="TPDUExtAuthData" select="AuthType" />
</struct>

<struct name="TPDUIdentInfo" version="10" >
	<entry name="Pos" type="int" />
	<entry name="Ident" type="char" count="TQQ_IDENT_LEN" />
</struct>

<struct name="TPDUExtIdent" version="10" >
	<entry name="Len" type="int" />
	<entry name="EncryptIdent" type="tinyint" count="TPDU_MAX_ENCRYPTIDENT_LEN" refer="Len" />
</struct>

<struct name="TPDUExtRelay" version="10" >
  <entry name="RelayType"    type="int" />
  <entry name="OldPos"       type="int" />
	<entry name="Len"          type="int" />
	<entry name="EncryptIdent" type="tinyint" count="TPDU_MAX_ENCRYPTIDENT_LEN" refer="Len" />
</struct>

<struct name="TPDUExtStop" version="10" >
  <entry name="StopReason" type="int" />
</struct>

<struct name="TPDUSynInfo" version="10" >
  <entry name="randstr" type="char" count="TQQ_IDENT_LEN"/>
</struct>
  
<struct name="TPDUExtSyn" version="10" >
  <entry name="Len"            type="tinyuint" />
  <entry name="EncryptSynInfo"    type="tinyint" count="TPDU_MAX_ENCRYPTSYN_LEN" refer="Len" /> 
</struct>

<struct name="TPDUExtSynAck" version="10" >
  <entry name="Len" type="tinyuint" />
  <entry name="EncryptSynInfo" type="tinyuint" count="TPDU_MAX_ENCRYPTSYNACK_LEN" refer="Len" />
</struct>

<union name="TPDUExt" version="10" >
	<entry name="AuthInfo" type="TPDUExtAuthInfo" id="TPDU_CMD_AUTH" />
	<entry name="ChgSkey"  type="TPDUExtChgSkey"  id="TPDU_CMD_CHGSKEY" />
	<entry name="QueInfo"  type="TPDUExtQueInfo"  id="TPDU_CMD_QUEINFO" />
	<entry name="Ident"    type="TPDUExtIdent"    id="TPDU_CMD_IDENT" />
	<entry name="Relay"    type="TPDUExtRelay"    id="TPDU_CMD_RELAY" />
	<entry name="Stop"     type="TPDUExtStop"     id="TPDU_CMD_STOP" />
	<entry name="Syn"      type="TPDUExtSyn"  id="TPDU_CMD_SYN" />
	<entry name="SynAck"   type="TPDUExtSynAck"   id="TPDU_CMD_SYNACK" />
</union>

<struct name="TPDUHead" sizeinfo="Base.HeadLen" version="10" >
	<entry name="Base" type="TPDUBase" />
	<entry name="Ext"  type="TPDUExt" select="Base.Cmd" />
</struct>

<struct name="TPDUFrame" version="10" >
	<entry name="Head" type="TPDUHead" />
	<entry name="Body" type="tinyint" count="0" refer="Head.Base.BodyLen" />
</struct>

</metalib>
